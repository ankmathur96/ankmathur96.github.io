<!DOCTYPE html>
<!-- saved from url=(0078)https://inst.eecs.berkeley.edu/~cs194-26/fa17/upload/files/proj5/cs194-26-aey/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Project 5 - Ankit Mathur</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="description" content="Depth Refocusing and Aperture Adjustment"><meta property="og:site_name" content="Project 5 - Ankit Mathur"><meta property="og:title" content="Project 5 - Ankit Mathur"><meta property="og:type" content="article"><meta property="og:image" content="https://ankitmathurp5.carrd.co/assets/images/card.jpg?v12217528159051"><meta property="og:description" content="Depth Refocusing and Aperture Adjustment"><meta property="og:url" content="https://ankitmathurp5.carrd.co"><meta property="twitter:card" content="summary_large_image"><link href="./proj5_files/css" rel="stylesheet" type="text/css"><style>html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block;}body{line-height:1;}ol,ul{list-style:none;}blockquote,q{quotes:none;}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none;}table{border-collapse:collapse;border-spacing:0;}body{-webkit-text-size-adjust:none}mark{background-color:transparent;color:inherit}input::-moz-focus-inner{border:0;padding:0}input[type="text"],input[type="email"],select,textarea{-moz-appearance:none;-webkit-appearance:none;-ms-appearance:none;appearance:none}*, *:before, *:after {box-sizing: border-box;}body {min-width: 320px;min-height: 100vh;line-height: 1.0;word-wrap: break-word;overflow-x: hidden;}strong {color: inherit;font-weight: bolder;}em {font-style: italic;}code {font-family: "Lucida Console", "Courier New", monospace;font-weight: normal;text-indent: 0;letter-spacing: 0;font-size: 0.9em;margin: 0 0.25em;padding: 0.25em 0.5em;background-color: rgba(144,144,144,0.25);border-radius: 0.25em;}mark {background-color: rgba(144,144,144,0.25);}a {-moz-transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;-webkit-transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;-ms-transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;color: inherit;text-decoration: underline;}s {text-decoration: line-through;}body:before {content: '';display: block;position: fixed;top: 0;left: 0;width: 100vw;height: 100vh;z-index: 0;-moz-pointer-events: none;-webkit-pointer-events: none;-ms-pointer-events: none;pointer-events: none;-moz-transform: scale(1);-webkit-transform: scale(1);-ms-transform: scale(1);transform: scale(1);background-image: linear-gradient(to top, rgba(0,0,0,0.91), rgba(0,0,0,0.91)), url('assets/images/bg.gif?v12217528159051');background-position: 0% 0%, center;background-repeat: repeat, no-repeat;background-size: auto, 100% 100%;background-attachment: scroll;background-color: #FFFFFF;}body:after {display: block;content: '';position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: #000000;z-index: 1;opacity: 0;visibility: hidden;-moz-transition: opacity 1.5s ease-in-out 0s, visibility 1.5s 0s;-webkit-transition: opacity 1.5s ease-in-out 0s, visibility 1.5s 0s;-ms-transition: opacity 1.5s ease-in-out 0s, visibility 1.5s 0s;transition: opacity 1.5s ease-in-out 0s, visibility 1.5s 0s;-moz-transform: scale(1);-webkit-transform: scale(1);-ms-transform: scale(1);transform: scale(1);}body.is-loading:after {opacity: 1;visibility: visible;}html {font-size: 18pt;}#wrapper {-webkit-overflow-scrolling: touch;display: -moz-flex;display: -webkit-flex;display: -ms-flex;display: flex;-moz-flex-direction: column;-webkit-flex-direction: column;-ms-flex-direction: column;flex-direction: column;-moz-align-items: center;-webkit-align-items: center;-ms-align-items: center;align-items: center;-moz-justify-content: flex-start;-webkit-justify-content: flex-start;-ms-justify-content: flex-start;justify-content: flex-start;min-height: 100vh;position: relative;z-index: 2;overflow: hidden;}#main {display: -moz-flex;display: -webkit-flex;display: -ms-flex;display: flex;position: relative;max-width: 100%;z-index: 1;-moz-align-items: center;-webkit-align-items: center;-ms-align-items: center;align-items: center;-moz-justify-content: center;-webkit-justify-content: center;-ms-justify-content: center;justify-content: center;-moz-flex-grow: 0;-webkit-flex-grow: 0;-ms-flex-grow: 0;flex-grow: 0;-moz-flex-shrink: 0;-webkit-flex-shrink: 0;-ms-flex-shrink: 0;flex-shrink: 0;text-align: center;-moz-transition: opacity 1.5s ease-in-out 0s;-webkit-transition: opacity 1.5s ease-in-out 0s;-ms-transition: opacity 1.5s ease-in-out 0s;transition: opacity 1.5s ease-in-out 0s;}#main > .inner {position: relative;z-index: 1;border-radius: inherit;padding: 5rem 4rem;max-width: 100%;width: 59rem;}#main > .inner > * {margin-top: 1.5rem;margin-bottom: 1.5rem;}#main > .inner > :first-child {margin-top: 0 !important;}#main > .inner > :last-child {margin-bottom: 0 !important;}#main > .inner > .full {margin-left: calc(-4rem);width: calc(100% + 8rem + 0.4725px);max-width: calc(100% + 8rem + 0.4725px);}#main > .inner > .full:first-child {margin-top: -5rem !important;border-top-left-radius: inherit;border-top-right-radius: inherit;}#main > .inner > .full:last-child {margin-bottom: -5rem !important;border-bottom-left-radius: inherit;border-bottom-right-radius: inherit;}#main > .inner > .full.screen {width: 100vw;max-width: 100vw;position: relative;border-radius: 0 !important;left: 50%;right: auto;margin-left: -50vw;}body.is-loading #main {opacity: 0;}h1 br + br, h2 br + br, h3 br + br, p br + br {display: block;content: ' ';margin-top: 0.975rem;}h1 .li, h2 .li, h3 .li, p .li {display: list-item;padding-left: 0.5em;margin: 0.75em 0 0 1em;}#text02 br + br {margin-top: 0.825rem;}#text02 {font-family: 'Oswald';letter-spacing: 0.75rem;width: calc(100% + 0.75rem);font-size: 3em;line-height: 1.375;font-weight: 200;text-align: inherit;}#text06 br + br {margin-top: 0.9rem;}#text06 {font-family: 'Oswald';letter-spacing: 0.125rem;width: calc(100% + 0.125rem);font-size: 1.125em;line-height: 1.5;font-weight: 200;text-align: inherit;}#text11 {text-transform: none;}#text13 {text-align: center;font-size: 2em;font-weight: 400;}#text07 {text-transform: none;}#text03 {text-transform: none;}#text08 br + br {margin-top: 0.9rem;}#text08 {font-family: 'Oswald';letter-spacing: 0.125rem;width: calc(100% + 0.125rem);font-size: 1.125em;line-height: 1.5;font-weight: 200;text-align: inherit;}#text09 {text-transform: none;}#text04 {text-align: center;font-size: 2em;font-weight: 400;}#text01 {text-transform: none;}#text10 {text-transform: none;}#text05 {text-align: center;font-size: 2em;font-weight: 400;}#text12 {text-transform: none;}#text14 {text-transform: none;}#credits {font-size: 0.8em;text-transform: none;text-align: inherit;cursor: default;margin-top: 1rem !important;}#credits a {text-decoration: underline;-moz-transition: opacity 0.25s ease;-webkit-transition: opacity 0.25s ease;-ms-transition: opacity 0.25s ease;transition: opacity 0.25s ease;opacity: 0.5;text-decoration: none !important;}#credits a:hover {text-decoration: none;opacity: 1;text-decoration: none !important;}h1, h2, h3, p {text-transform: uppercase;color: #FFFFFF;font-family: 'Source Sans Pro';letter-spacing: 0.05rem;width: calc(100% + 0.05rem);font-size: 1em;line-height: 1.625;font-weight: 300;text-align: left;}hr {width: 100%;position: relative;padding: 0;border: 0;height: 0.5rem;line-height: 0.5rem;}hr:before {content: '';display: inline-block;vertical-align: middle;width: 16%;background-color: #FFFFFF;height: 2px;}.image {position: relative;overflow: hidden;max-width: 100%;display: block;}.image a, .image span {position: relative;max-width: 100%;display: inline-block;vertical-align: top;}.image a img, .image span img {display: block;}.image img {width: 100%;max-width: 100%;display: inline-block;vertical-align: top;}.image.full img {display: block;}.image.full:first-child img {border-top-left-radius: inherit;border-top-right-radius: inherit;}.image.full:last-child img {border-bottom-left-radius: inherit;border-bottom-right-radius: inherit;}.image.full a, .image.full span {display: block;}#image01 img {width: 42rem;}#image02 img {width: 42rem;}#image03 img {width: 42rem;}#image04 img {width: 42rem;}.gallery .inner {display: inline-block;max-width: 100%;max-width: 100rem;}.gallery ul li {display: inline-block;margin: 0.5rem;}.gallery ul li a, .gallery ul li span {display: inline-block;position: relative;border-radius: 0rem;}.gallery ul li img {display: inline-block;width: auto;max-width: 100%;margin: 0;vertical-align: top;height: auto;max-height: 8.125rem;border-radius: 0rem;}#gallery01 ul {padding: 1.18125rem 0;}#gallery01 ul li img {max-height: 13.5rem;}#gallery02 ul {padding: 1.18125rem 0;}#gallery02 ul li img {max-height: 13.5rem;}.gallery ul {padding: 0.7109375rem 0;width: calc(100% + 1rem);margin-left: -0.5rem;}.video {position: relative;}.video video {display: inline-block;vertical-align: top;max-width: 100%;}.video .frame {position: relative;overflow: hidden;max-width: 100%;display: inline-block;vertical-align: top;}.video .frame:before {content: '';display: block;width: 100%;}.video .frame iframe {position: absolute;top: 0px;right: 0px;bottom: 0px;left: 0px;width: 100%;height: 100%;background-color: rgba(32,32,32,0.25);}.video.full video {display: block;}.video.full:first-child video {border-top-left-radius: inherit;border-top-right-radius: inherit;}.video.full:last-child video {border-bottom-left-radius: inherit;border-bottom-right-radius: inherit;}.video.full .frame {display: block;}.video.full:first-child .frame {border-top-left-radius: inherit;border-top-right-radius: inherit;}.video.full:last-child .frame {border-bottom-left-radius: inherit;border-bottom-right-radius: inherit;}#video01 video {width: 26rem;}#video01 .frame {width: 26rem;}#video01 .frame:before {padding-top: 56.25%;}#video02 video {width: 38rem;}#video02 .frame {width: 38rem;}#video02 .frame:before {padding-top: 56.25%;}#video03 video {width: 38rem;}#video03 .frame {width: 38rem;}#video03 .frame:before {padding-top: 56.25%;}#video04 video {width: 38rem;}#video04 .frame {width: 38rem;}#video04 .frame:before {padding-top: 56.25%;}@media (max-width: 1680px) {html {font-size: 13pt;}}@media (max-width: 1280px) {html {font-size: 13pt;}}@media (max-width: 980px) {html {font-size: 11pt;}}@media (max-width: 736px) {html {font-size: 11pt;}#main > .inner {padding: 3.5rem 2rem;}#main > .inner > * {margin-top: 1.5rem;margin-bottom: 1.5rem;}#main > .inner > .full {margin-left: calc(-2rem);width: calc(100% + 4rem + 0.4725px);max-width: calc(100% + 4rem + 0.4725px);}#main > .inner > .full:first-child {margin-top: -3.5rem !important;}#main > .inner > .full:last-child {margin-bottom: -3.5rem !important;}#main > .inner > .full.screen {margin-left: -50vw;}#divider01 {height: 0.5rem;line-height: 0.5rem;}#divider02 {height: 0.5rem;line-height: 0.5rem;}#image01 img {width: 42rem;}#image02 img {width: 42rem;}#image03 img {width: 42rem;}#image04 img {width: 42rem;}#video01 video {width: 26rem;}#video01 .frame {width: 26rem;}#video02 video {width: 38rem;}#video02 .frame {width: 38rem;}#video03 video {width: 38rem;}#video03 .frame {width: 38rem;}#video04 video {width: 38rem;}#video04 .frame {width: 38rem;}}@media (max-width: 480px) {#main > .inner > * {margin-top: 1.3125rem;margin-bottom: 1.3125rem;}}@media (max-width: 360px) {#main > .inner {padding: 2.625rem 1.5rem;}#main > .inner > * {margin-top: 1.125rem;margin-bottom: 1.125rem;}#main > .inner > .full {margin-left: calc(-1.5rem);width: calc(100% + 3rem + 0.4725px);max-width: calc(100% + 3rem + 0.4725px);}#main > .inner > .full:first-child {margin-top: -2.625rem !important;}#main > .inner > .full:last-child {margin-bottom: -2.625rem !important;}#main > .inner > .full.screen {margin-left: -50vw;}#text02 {font-size: 2em;}#text13 {font-size: 1.5em;}#text04 {font-size: 1.5em;}#text05 {font-size: 1.5em;}#gallery01 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery01 ul li {margin: 0.375rem;}#gallery02 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery02 ul li {margin: 0.375rem;}#gallery03 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery03 ul li {margin: 0.375rem;}#gallery04 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery04 ul li {margin: 0.375rem;}#gallery05 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery05 ul li {margin: 0.375rem;}}</style><noscript>&amp;lt;style&amp;gt;body {overflow: auto !important;}body:after {display: none !important;}#main &amp;gt; .inner {opacity: 1.0 !important;}#main {opacity: 1.0 !important;-moz-transform: none !important;-webkit-transform: none !important;-ms-transform: none !important;transform: none !important;-moz-transition: none !important;-webkit-transition: none !important;-ms-transition: none !important;transition: none !important;-moz-filter: none !important;-webkit-filter: none !important;-ms-filter: none !important;filter: none !important;}&amp;lt;/style&amp;gt;</noscript><style></style><style></style><style></style></head><body class="is-ready"><div id="wrapper"><div id="main"><div class="inner"><h1 id="text02">Project 5: Focusing</h1><p id="text06">By Ankit Mathur</p><p id="text11">What I learned about light fields from this project is that it is a much richer abstraction to represent a visual space. Rather than being limited to measuring intensity on multiple channels like a normal camera, by attempting to capture the lightfield with a Lytro-style camera, one can obtain very interesting effects like the ones that we are about to discuss.</p><hr id="divider01"><h2 id="text13">Depth Refocusing</h2><p id="text07">In part 1 of this project, we worked on using a field of images that were taken in a 17x17 grid and using them to be able to refocus a given image to a different part of the image. For example, we may want to focus the image onto the front of the image. We take advantage of the fact that we have a significant amount of data about the scene because of the many photos that we have which are taken at different angles.</p><p id="text03">By shifting the images to align at the center and using a constant, A, to control how much we're shifting the other images. We compute dx and dy relative to the center of the center image for every other image simply by subtracting the center point from the grid position of an image within the grid of images that are taken as input to the algorithm.</p><div class="image" id="image01"><img src="./proj5_files/image01.jpg" alt=""></div><div class="gallery" id="gallery01"><div class="inner"><ul><li><img src="./proj5_files/01.jpg" alt="Untitled"></li><li><img src="./proj5_files/02.jpg" alt="Untitled"></li><li><img src="./proj5_files/03.jpg" alt="Untitled"></li><li><img src="./proj5_files/04.jpg" alt="Untitled"></li></ul></div></div><div class="video" id="video01"><video src="./Project 5 - Ankit Mathur_files/bracelet.mp4" poster="./Project 5 - Ankit Mathur_files/bracelet.mp4" playsinline="" autoplay="" loop=""></video></div><div class="image" id="image02"><img src="./proj5_files/image02.jpg" alt=""></div><div class="video" id="video02"><video src="./Project 5 - Ankit Mathur_files/chess.mp4" poster="./Project 5 - Ankit Mathur_files/chess.mp4" playsinline="" autoplay="" loop=""></video></div><p id="text08">Best Result for Depth Refocusing:</p><p id="text09">Original Image:</p><div class="image" id="image03"><img src="./proj5_files/image03.jpg" alt=""></div><div class="video" id="video03"><div class="frame"><iframe width="560" height="315" src="./proj5_files/AtTKtQenibE.html" frameborder="0" allowfullscreen=""></iframe></div></div><hr id="divider02"><h2 id="text04">Aperture Adjustment</h2><p id="text01"><span>In part 2, we want to simulate adjusting the aperture of the image that we are refocusing. We do this by limiting the region of images that we translate and compute an average over. If we used just a single image, then we would be simulating the tiniest possible aperture. Allowing more images from different angles to contribute to the average simulates allowing light from a wider range of angles into the image, simulating a larger aperture. </span><br> <br> <span>Thus, we simply use our depth refocusing function, but we pass in a cropped image grid.</span></p><p id="text10"><span>Here, we use the pirate treasure example to observe how we can change the aperture. The image with all the details is the one with the smallest aperture and the one with the largest is the focused one. </span><br> <br> <span>The images below are with radius 0, 2 and 5.</span><br> <br> <span>The GIF loops back and shows the transition in both directions:</span></p><div class="gallery" id="gallery02"><div class="inner"><ul><li><img src="./proj5_files/01(1).jpg" alt="Untitled"></li><li><img src="./proj5_files/02(1).jpg" alt="Untitled"></li><li><img src="./proj5_files/03(1).jpg" alt="Untitled"></li></ul></div></div><div class="video" id="video04"><video src="./Project 5 - Ankit Mathur_files/pirate_treasure_aperture.mp4" poster="./Project 5 - Ankit Mathur_files/pirate_treasure_aperture.mp4" playsinline="" autoplay="" loop=""></video></div><h2 id="text05">Bells and Whistles: My Own Images</h2><div class="gallery" id="gallery03"><div class="inner"><ul><li><img src="./proj5_files/01(2).jpg" alt="0_1"></li><li><img src="./proj5_files/02(2).jpg" alt="0_2"></li><li><img src="./proj5_files/03(2).jpg" alt="0_3"></li></ul></div></div><div class="gallery" id="gallery04"><div class="inner"><ul><li><img src="./proj5_files/01(3).jpg" alt="1_1"></li><li><img src="./proj5_files/02(3).jpg" alt="1_2"></li><li><img src="./proj5_files/03(3).jpg" alt="1_3"></li></ul></div></div><div class="gallery" id="gallery05"><div class="inner"><ul><li><img src="./proj5_files/01(4).jpg" alt="2_1"></li><li><img src="./proj5_files/02(4).jpg" alt="2_2"></li><li><img src="./proj5_files/03(4).jpg" alt="2_3"></li></ul></div></div><p id="text12"><span>I obtained this 3x3 grid of images from Google Maps and tried to use it to create an autofocus environment. To do this, I had to screenshot a scene, then shift the Street View viewer, then take another screenshot, etc. I generated vertical shifts by changing the axis of viewing that I had in the Street View viewer. </span><br> <br> <span>Unfortunately, this did not work, resulting in the following image for most of the potential alpha values:</span></p><div class="image" id="image04"><img src="./proj5_files/image04.jpg" alt=""></div><p id="text14"><span>I think that this did not work because the vertical axis shift was too significant - I was doing this by hand, and, you can clearly see the person being replicated vertically across many of the images. This prevents any alignment from occurring.</span><br> <br> <span>Furthermore, and potentially more significantly, the image is such that there is no one thing that is in the foreground. Because this is a Google Street View image, all of the material is in the background, which is naturally going to be farther away and more likely to vary across images. </span><br> <br> <span>It is definitely not easy to get a good set of images without a specialized camera or set up for this purpose.</span></p><p id="credits"><a href="https://carrd.co/">( Made with Carrd )</a></p></div></div></div><script>var on = addEventListener,$ = function(q) { return document.querySelector(q) },$$ = function(q) { return document.querySelectorAll(q) },$body = document.body,$inner = $('.inner'),client = (function() {var o = {browser: 'other',browserVersion: 0,os: 'other',osVersion: 0},ua = navigator.userAgent,a, i;a = [['firefox', /Firefox\/([0-9\.]+)/],['edge', /Edge\/([0-9\.]+)/],['safari', /Version\/([0-9\.]+).+Safari/],['chrome', /Chrome\/([0-9\.]+)/],['ie', /Trident\/.+rv:([0-9]+)/]];for (i=0; i < a.length; i++) {if (ua.match(a[i][1])) {o.browser = a[i][0];o.browserVersion = parseFloat(RegExp.$1);break;}}a = [['ios', /([0-9_]+) like Mac OS X/, function(v) { return v.replace('_', '.').replace('_', ''); }],['ios', /CPU like Mac OS X/, function(v) { return 0 }],['android', /Android ([0-9\.]+)/, null],['mac', /Macintosh.+Mac OS X ([0-9_]+)/, function(v) { return v.replace('_', '.').replace('_', ''); }],['windows', /Windows NT ([0-9\.]+)/, null]];for (i=0; i < a.length; i++) {if (ua.match(a[i][1])) {o.os = a[i][0];o.osVersion = parseFloat( a[i][2] ? (a[i][2])(RegExp.$1) : RegExp.$1 );break;}}return o;}()),trigger = function(t) {if (client.browser == 'ie') {var e = document.createEvent('Event');e.initEvent(t, false, true);dispatchEvent(e);} else dispatchEvent(new Event(t));};on('load', function() {setTimeout(function() {$body.className = $body.className.replace(/\bis-loading\b/, 'is-playing');setTimeout(function() {$body.className = $body.className.replace(/\bis-playing\b/, 'is-ready');}, 1500);}, 100);});var style, sheet, rule;style = document.createElement('style');style.appendChild(document.createTextNode(''));document.head.appendChild(style);sheet = style.sheet;if (client.os == 'android') {(function() {sheet.insertRule('body::after { }', 0);rule = sheet.cssRules[0];var f = function() {rule.style.cssText = 'height: ' + (Math.max(screen.width, screen.height)) + 'px';};on('load', f);on('orientationchange', f);on('touchmove', f);})();} else  if (client.os == 'ios') {(function() {sheet.insertRule('body::after { }', 0);rule = sheet.cssRules[0];rule.style.cssText = '-webkit-transform: scale(1.0)';})();(function() {sheet.insertRule('body.ios-focus-fix::before { }', 0);rule = sheet.cssRules[0];rule.style.cssText = 'height: calc(100% + 60px)';on('focus', function(event) {$body.classList.add('ios-focus-fix');}, true);on('blur', function(event) {$body.classList.remove('ios-focus-fix');}, true);})();} else  if (client.browser == 'ie') {(function() {var t, f;f = function() {var mh, h, s, xx, x, i;x = $('#wrapper');x.style.height = 'auto';if (x.scrollHeight <= innerHeight)x.style.height = '100vh';xx = $$('.container.full');for (i=0; i < xx.length; i++) {x = xx[i];s = getComputedStyle(x);x.style.minHeight = '';x.style.height = '';mh = s.minHeight;x.style.minHeight = 0;x.style.height = '';h = s.height;if (mh == 0)continue;x.style.height = (h > mh ? 'auto' : mh);}};(f)();on('resize', function() {clearTimeout(t);t = setTimeout(f, 250);});on('load', f);})();}</script></body></html>