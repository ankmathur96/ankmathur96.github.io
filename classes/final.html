<!DOCTYPE html>
<!-- saved from url=(0090)https://inst.eecs.berkeley.edu/~cs194-26/fa17/upload/files/projFinalProposed/cs194-26-aey/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Neural Style Transfer</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="description" content="by Anaga Rajan and Ankit Mathur"><meta property="og:site_name" content="Neural Style Transfer"><meta property="og:title" content="Neural Style Transfer"><meta property="og:type" content="article"><meta property="og:image" content="https://neuralstyletransfer.carrd.co/assets/images/card.jpg?v34476219923151"><meta property="og:description" content="by Anaga Rajan and Ankit Mathur"><meta property="og:url" content="https://neuralstyletransfer.carrd.co"><meta property="twitter:card" content="summary_large_image"><link href="./final_files/css" rel="stylesheet" type="text/css"><style>html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block;}body{line-height:1;}ol,ul{list-style:none;}blockquote,q{quotes:none;}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none;}table{border-collapse:collapse;border-spacing:0;}body{-webkit-text-size-adjust:none}mark{background-color:transparent;color:inherit}input::-moz-focus-inner{border:0;padding:0}input[type="text"],input[type="email"],select,textarea{-moz-appearance:none;-webkit-appearance:none;-ms-appearance:none;appearance:none}*, *:before, *:after {box-sizing: border-box;}body {min-width: 320px;min-height: 100vh;line-height: 1.0;word-wrap: break-word;overflow-x: hidden;}strong {color: inherit;font-weight: bolder;}em {font-style: italic;}code {font-family: "Lucida Console", "Courier New", monospace;font-weight: normal;text-indent: 0;letter-spacing: 0;font-size: 0.9em;margin: 0 0.25em;padding: 0.25em 0.5em;background-color: rgba(144,144,144,0.25);border-radius: 0.25em;}mark {background-color: rgba(144,144,144,0.25);}a {-moz-transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;-webkit-transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;-ms-transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;transition: color 0.25s ease, background-color 0.25s ease, border-color 0.25s ease;color: inherit;text-decoration: underline;}s {text-decoration: line-through;}body:before {content: '';display: block;background-image: linear-gradient(0deg, #6EB1B5 0%, #544C85 100%);position: fixed;top: 0;left: 0;width: 100vw;height: 100vh;z-index: 0;-moz-pointer-events: none;-webkit-pointer-events: none;-ms-pointer-events: none;pointer-events: none;-moz-transform: scale(1);-webkit-transform: scale(1);-ms-transform: scale(1);transform: scale(1);}html {font-size: 18pt;}#wrapper {-webkit-overflow-scrolling: touch;display: -moz-flex;display: -webkit-flex;display: -ms-flex;display: flex;-moz-flex-direction: column;-webkit-flex-direction: column;-ms-flex-direction: column;flex-direction: column;-moz-align-items: center;-webkit-align-items: center;-ms-align-items: center;align-items: center;-moz-justify-content: center;-webkit-justify-content: center;-ms-justify-content: center;justify-content: center;min-height: 100vh;position: relative;z-index: 2;overflow: hidden;}#main {display: -moz-flex;display: -webkit-flex;display: -ms-flex;display: flex;position: relative;max-width: 100%;z-index: 1;-moz-align-items: center;-webkit-align-items: center;-ms-align-items: center;align-items: center;-moz-justify-content: center;-webkit-justify-content: center;-ms-justify-content: center;justify-content: center;-moz-flex-grow: 0;-webkit-flex-grow: 0;-ms-flex-grow: 0;flex-grow: 0;-moz-flex-shrink: 0;-webkit-flex-shrink: 0;-ms-flex-shrink: 0;flex-shrink: 0;text-align: left;-moz-transition: opacity 1s ease 0s,-moz-filter 1s ease 0s;-webkit-transition: opacity 1s ease 0s,-webkit-filter 1s ease 0s;-ms-transition: opacity 1s ease 0s,-ms-filter 1s ease 0s;transition: opacity 1s ease 0s,filter 1s ease 0s;}#main > .inner {position: relative;z-index: 1;border-radius: inherit;padding: 3.75rem 3rem;max-width: 100%;width: 57rem;}#main > .inner > * {margin-top: 1.25rem;margin-bottom: 1.25rem;}#main > .inner > :first-child {margin-top: 0 !important;}#main > .inner > :last-child {margin-bottom: 0 !important;}#main > .inner > .full {margin-left: calc(-3rem);width: calc(100% + 6rem + 0.4725px);max-width: calc(100% + 6rem + 0.4725px);}#main > .inner > .full:first-child {margin-top: -3.75rem !important;border-top-left-radius: inherit;border-top-right-radius: inherit;}#main > .inner > .full:last-child {margin-bottom: -3.75rem !important;border-bottom-left-radius: inherit;border-bottom-right-radius: inherit;}#main > .inner > .full.screen {width: 100vw;max-width: 100vw;position: relative;border-radius: 0 !important;left: 50%;right: auto;margin-left: -50vw;}body.is-loading #main {opacity: 0;-moz-filter: blur(2px);-webkit-filter: blur(2px);-ms-filter: blur(2px);filter: blur(2px);}@-moz-keyframes deferred-spinner {0% {-moz-transform: rotate(0deg);-webkit-transform: rotate(0deg);-ms-transform: rotate(0deg);transform: rotate(0deg);}100% {-moz-transform: rotate(360deg);-webkit-transform: rotate(360deg);-ms-transform: rotate(360deg);transform: rotate(360deg);}}@-webkit-keyframes deferred-spinner {0% {-moz-transform: rotate(0deg);-webkit-transform: rotate(0deg);-ms-transform: rotate(0deg);transform: rotate(0deg);}100% {-moz-transform: rotate(360deg);-webkit-transform: rotate(360deg);-ms-transform: rotate(360deg);transform: rotate(360deg);}}@-ms-keyframes deferred-spinner {0% {-moz-transform: rotate(0deg);-webkit-transform: rotate(0deg);-ms-transform: rotate(0deg);transform: rotate(0deg);}100% {-moz-transform: rotate(360deg);-webkit-transform: rotate(360deg);-ms-transform: rotate(360deg);transform: rotate(360deg);}}@keyframes deferred-spinner {0% {-moz-transform: rotate(0deg);-webkit-transform: rotate(0deg);-ms-transform: rotate(0deg);transform: rotate(0deg);}100% {-moz-transform: rotate(360deg);-webkit-transform: rotate(360deg);-ms-transform: rotate(360deg);transform: rotate(360deg);}}.deferred:before {content: '';display: block;width: 4rem;height: 4rem;position: absolute;top: 50%;left: 50%;margin: -2rem 0 0 -2rem;-moz-animation: deferred-spinner 1s infinite linear;-webkit-animation: deferred-spinner 1s infinite linear;-ms-animation: deferred-spinner 1s infinite linear;animation: deferred-spinner 1s infinite linear;transition: opacity 0.25s ease;transition-delay: 0.5s;opacity: 0;z-index: -1;background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iOTZweCIgaGVpZ2h0PSI5NnB4IiB2aWV3Qm94PSIwIDAgOTYgOTYiIHpvb21BbmRQYW49ImRpc2FibGUiPjxzdHlsZT5jaXJjbGUge2ZpbGw6IHRyYW5zcGFyZW50OyBzdHJva2U6ICNmZmY7IHN0cm9rZS13aWR0aDogMS41cHg7IH08L3N0eWxlPjxkZWZzPjxjbGlwUGF0aCBpZD0iY29ybmVyIj48cG9seWdvbiBwb2ludHM9IjAsMCA0OCwwIDQ4LDQ4IDk2LDQ4IDk2LDk2IDAsOTYiIC8+PC9jbGlwUGF0aD48L2RlZnM+PGcgY2xpcC1wYXRoPSJ1cmwoI2Nvcm5lcikiPjxjaXJjbGUgY3g9IjQ4IiBjeT0iNDgiIHI9IjMyIi8+PC9nPjwvc3ZnPg==');background-position: center;background-repeat: no-repeat;background-size: 3rem;}.deferred.loading:before {opacity: 0.25;z-index: 0;}h1 br + br, h2 br + br, h3 br + br, p br + br {display: block;content: ' ';margin-top: 0.9rem;}h1 .li, h2 .li, h3 .li, p .li {display: list-item;padding-left: 0.5em;margin: 0.75em 0 0 1em;}#text01 br + br {margin-top: 0.75rem;}#text01 {color: #FFFFFF;font-size: 3.5em;line-height: 1.25;}#text02 {font-size: 1.5em;letter-spacing: 0;width: auto;}#text03 {font-size: 1em;font-weight: 300;letter-spacing: 0;width: auto;}#text03 a {text-decoration: underline;}#text03 a:hover {text-decoration: none;}#text05 {font-size: 1.5em;font-weight: 700;letter-spacing: 0;width: auto;}#text06 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text18 {font-size: 1.5em;font-weight: 700;letter-spacing: 0;width: auto;}#text08 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text10 {letter-spacing: 0;width: auto;}#text04 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text11 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text13 {letter-spacing: 0;width: auto;}#text12 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text14 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text16 {letter-spacing: 0;width: auto;}#text09 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text17 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text22 {letter-spacing: 0;width: auto;}#text25 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text21 {font-size: 1.5em;font-weight: 700;letter-spacing: 0;width: auto;}#text23 {letter-spacing: 0;width: auto;}#text26 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text24 {letter-spacing: 0;width: auto;}#text27 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text28 {letter-spacing: 0;width: auto;}#text15 {font-size: 1.125em;font-weight: 200;letter-spacing: 0;width: auto;}#text07 {font-size: 1.5em;font-weight: 700;letter-spacing: 0;width: auto;}#text29 {letter-spacing: 0;width: auto;}#text30 {letter-spacing: 0;width: auto;}#text31 {letter-spacing: 0;width: auto;}#text32 {letter-spacing: 0;width: auto;}#text33 {letter-spacing: 0;width: auto;}#text34 {letter-spacing: 0;width: auto;}#text35 {letter-spacing: 0;width: auto;}#text19 {font-size: 1.375em;font-weight: 700;letter-spacing: 0;width: auto;}#text20 {font-size: 1.375em;font-weight: 700;letter-spacing: 0;width: auto;}#credits {font-size: 0.8em;letter-spacing: 0;width: auto;cursor: default;margin-top: 1rem !important;}#credits a {text-decoration: underline;-moz-transition: opacity 0.25s ease;-webkit-transition: opacity 0.25s ease;-ms-transition: opacity 0.25s ease;transition: opacity 0.25s ease;opacity: 0.5;text-decoration: none !important;}#credits a:hover {text-decoration: none;opacity: 1;text-decoration: none !important;}h1, h2, h3, p {color: rgba(255,255,255,0.627);font-family: 'Source Sans Pro';letter-spacing: -0.2rem;width: 100%;font-size: 1.25em;line-height: 1.5;font-weight: 400;}.image {position: relative;overflow: hidden;max-width: 100%;display: block;}.image a, .image span {position: relative;max-width: 100%;display: inline-block;vertical-align: top;}.image a img, .image span img {display: block;}.image img {width: 100%;max-width: 100%;display: inline-block;vertical-align: top;}.image.full img {display: block;}.image.full:first-child img {border-top-left-radius: inherit;border-top-right-radius: inherit;}.image.full:last-child img {border-bottom-left-radius: inherit;border-bottom-right-radius: inherit;}.image.full a, .image.full span {display: block;}#image01 img {width: 27.125rem;}#image02 img {width: 27.125rem;}#image03 img {width: 27.125rem;}#image04 img {width: 8.875rem;}#image05 img {width: 15.875rem;}#image06 img {width: 12.125rem;}#image14 img {width: 27.625rem;}#image07 img {width: 27.125rem;}#image08 img {width: 27.125rem;}#image09 img {width: 45.875rem;}#image10 img {width: 45.875rem;}#image11 img {width: 45.875rem;}#image13 img {width: 27.625rem;}#image12 img {width: 45.875rem;}#image15 img {width: 27.625rem;}#image16 img {width: 27.625rem;}.gallery .inner {display: inline-block;max-width: 100%;max-width: 100rem;}.gallery ul li {display: inline-block;margin: 0.5rem;}.gallery ul li a, .gallery ul li span {display: inline-block;position: relative;border-radius: 0rem;}.gallery ul li img {display: inline-block;width: auto;max-width: 100%;margin: 0;vertical-align: top;height: auto;max-height: 15.75rem;border-radius: 0rem;}#gallery01 ul {padding: 0.9296875rem 0;}#gallery01 ul li img {max-height: 10.625rem;}#gallery02 ul {padding: 1.3671875rem 0;}#gallery02 ul li img {max-height: 15.625rem;}#gallery09 ul {padding: 0.9296875rem 0;}#gallery09 ul li img {max-height: 10.625rem;}.gallery ul {padding: 1.378125rem 0;width: calc(100% + 1rem);margin-left: -0.5rem;}@media (max-width: 1680px) {html {font-size: 13pt;}}@media (max-width: 1280px) {html {font-size: 13pt;}}@media (max-width: 980px) {html {font-size: 11pt;}}@media (max-width: 736px) {html {font-size: 11pt;}#main > .inner {padding: 3.5rem 2rem;}#main > .inner > * {margin-top: 1.25rem;margin-bottom: 1.25rem;}#main > .inner > .full {margin-left: calc(-2rem);width: calc(100% + 4rem + 0.4725px);max-width: calc(100% + 4rem + 0.4725px);}#main > .inner > .full:first-child {margin-top: -3.5rem !important;}#main > .inner > .full:last-child {margin-bottom: -3.5rem !important;}#main > .inner > .full.screen {margin-left: -50vw;}#text01 {font-size: 3em;}#image01 img {width: 27.125rem;}#image02 img {width: 27.125rem;}#image03 img {width: 27.125rem;}#image04 img {width: 8.875rem;}#image05 img {width: 15.875rem;}#image06 img {width: 12.125rem;}#image14 img {width: 27.625rem;}#image07 img {width: 27.125rem;}#image08 img {width: 27.125rem;}#image09 img {width: 45.875rem;}#image10 img {width: 45.875rem;}#image11 img {width: 45.875rem;}#image13 img {width: 27.625rem;}#image12 img {width: 45.875rem;}#image15 img {width: 27.625rem;}#image16 img {width: 27.625rem;}}@media (max-width: 480px) {#main > .inner > * {margin-top: 1.09375rem;margin-bottom: 1.09375rem;}}@media (max-width: 360px) {#main > .inner {padding: 2.625rem 1.5rem;}#main > .inner > * {margin-top: 0.9375rem;margin-bottom: 0.9375rem;}#main > .inner > .full {margin-left: calc(-1.5rem);width: calc(100% + 3rem + 0.4725px);max-width: calc(100% + 3rem + 0.4725px);}#main > .inner > .full:first-child {margin-top: -2.625rem !important;}#main > .inner > .full:last-child {margin-bottom: -2.625rem !important;}#main > .inner > .full.screen {margin-left: -50vw;}#gallery01 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery01 ul li {margin: 0.375rem;}#gallery02 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery02 ul li {margin: 0.375rem;}#gallery03 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery03 ul li {margin: 0.375rem;}#gallery04 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery04 ul li {margin: 0.375rem;}#gallery05 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery05 ul li {margin: 0.375rem;}#gallery06 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery06 ul li {margin: 0.375rem;}#gallery08 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery08 ul li {margin: 0.375rem;}#gallery07 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery07 ul li {margin: 0.375rem;}#gallery09 ul {width: calc(100% + 0.75rem);margin-left: -0.375rem;}#gallery09 ul li {margin: 0.375rem;}}</style><noscript>&amp;lt;style&amp;gt;body {overflow: auto !important;}#main {opacity: 1.0 !important;-moz-transform: none !important;-webkit-transform: none !important;-ms-transform: none !important;transform: none !important;-moz-transition: none !important;-webkit-transition: none !important;-ms-transition: none !important;transition: none !important;-moz-filter: none !important;-webkit-filter: none !important;-ms-filter: none !important;filter: none !important;}&amp;lt;/style&amp;gt;</noscript><style></style><style></style><style></style></head><body class="is-ready"><div id="wrapper"><div id="main"><div class="inner"><h1 id="text01">Neural Style Transfer</h1><h2 id="text02">by Anaga Rajan and Ankit Mathur</h2><p id="text03">Project Github: <a href="https://www.github.com/rajananaga/neural-style-transfer">github.com/rajananaga/neural-style-transfer</a></p><h2 id="text05">Introduction</h2><p id="text06">What does it mean to be an human in the visual world? It does not just mean just seeing. Countless blind artists could not see, yet they produced some of the most outstanding artwork of all time. These people do not just use sight to classify an object, they use touch. There's something deeper here - texture and color are different parts of art. As we drive forward in the world of computational photography, we can see that the latest developments have focused on teaching machines how to actually create visual beauty. Just like a child, we want to teach them not only how to classify these images but also how to construct textures and objects. We want to teach them to be artists. This is the ambitious goal of this research.</p><h2 id="text18">Algorithm</h2><p id="text08"><span>The simplest step in this endeavor is to find a way that we can show an algorithm a style of art and a normal image and have the algorithm paint that image in the style of the first. The Gatys et al '14 paper "Image Style Transfer Using Convolutional Neural Networks" describes an algorithm to do this.</span><br> <br> <span>The fundamental basis of the algorithm that is described by the Gatys et al '14 paper seeks to optimize for a content and style loss. This is a reasonable abstraction for a way to create an image that has the same style as the original image but still looks like the prior image.</span></p><p id="text10">Convolutional Neural Networks</p><p id="text04"><span>The method prescribed by the paper asserts that the output of performing certain convolutions on the different parts of the image can be used as signal about what exists in those regions. This makes sense, since the convolutional operator essentially gives you some high level information about the regions it is convoluting over. </span><br> <br> <span>Then, it must be decided what kind of convolutions we want output from. Here, we bring in the VGG19 neural network. Originally designed for the broad scale image classification case, we are actually more interested in the structure of the network. Here is what it looks like:</span></p><div class="image" id="image01"><img src="./final_files/image01.jpg" alt=""></div><p id="text11"><span>Note how the first layers of the convolution have the image as a larger component - this implies that the convolutions you do will give you more fine-grained details.</span><br> <br> <span>What the paper asks us to do is to get the convolutional filter responses from a certain set of convolutional layers. Based on which layer one gets the filter responses from, you would get different kinds of information about the image.</span></p><p id="text13">Content Loss</p><p id="text12">The paper defines the content loss as the sum of the L2 losses between the corresponding filter responses at the layers of the target image and the content image.</p><div class="image" id="image02"><img src="./final_files/image02.jpg" alt=""></div><p id="text14">The paper suggests that we use the <code>conv4-2</code> layer's filter outputs. This is because <code>conv4-2</code> preserves the content while losing the high frequency details (as a result of being from a later layer of the convolutional network). These are some results obtained from the different kinds of content layers one could match on:</p><div class="image" id="image03"><img src="./final_files/image03.jpg" alt=""></div><p id="text16">Style Loss</p><p id="text09">The style loss is much more difficult to intuitively describe. In essence, what the paper asserts is that we want the low and high level style features. Thus, we should be using layers throughout the convolutional depth for that (i.e. <code>conv1-1</code>, <code>conv2-1</code>, <code>conv3-1</code>, <code>conv4-1</code>, and <code>conv5-1</code>)</p><p id="text17"><span>To get a representation of style given a certain layer, the Gram matrix is composed. In essence, what this is is an autocorrelation of the different convolutional filter responses with every other filter response for the same image. In words, one might describe this as being a representation of style because it represents how different components of the image relate to each other, defining, in a way, the style of the image. </span><br> <br> <span>To compute the loss, one computes the G matrix for the target and the style image and considers the L2 loss between them:</span></p><div class="image" id="image04"><img src="./final_files/image04.jpg" alt=""></div><div class="image" id="image05"><img src="./final_files/image05.jpg" alt=""></div><div class="image" id="image06"><img src="./final_files/image06.jpg" alt=""></div><p id="text22">Optimization</p><p id="text25">The loss is then weighted with constants alpha and beta to describe how much style and how much content we want. We use the L-BFGS optimizer with the learning rate 1. We start from the content image for the most interesting results. At every step of the optimization, we add an extra constraint which keeps the result between the values 0 and 1.</p><h2 id="text21">Learnings</h2><p id="text23">Layer Selection</p><p id="text26"><span>We found several things that created better results than the Gatys paper. For example, to obtain aesthetically pleasing results, rather than varying the style weights, we found using different layers for matching the style and content to be a better tunable hyperparameter. This was inspired by other work critical of the Gatys work's findings. The Nikulin work names this Partial Style Transfer, but they explore only a specific alternative layer configuration of content using (<code>conv1-1, conv2-1, conv3-1, conv4-1, conv5-1</code>) and style using (<code>conv3-1, conv5-1</code>). We explore a more custom approach based on the style image - if the style image contains more of the high level features (like cubism), then we will use the higher layers for style and not the lower ones (see the Cubism and the Afremov examples): </span><br> <br> <span>Furthermore, if the content image is extremely detailed, we will use only <code>conv5-2</code> as the matching layer for content. This retains even less of the sharp detail as compared with <code>conv4-2</code>. We feel that this led to significantly more pleasing results on average than the standard parameters (see the Mediterranean Garden and Self-Portrait).</span></p><p id="text24">Initialization</p><p id="text27">We found that, while the Gatys paper contends that the initialization does not matter, it makes a significant difference. Starting with the content image leads to aesthetically pleasing results that converge faster. The Nikulin et al work explores this as well, in direct contrast with the original Gatys et al paper which explicitly contends that the initialization does not matter</p><p id="text28">Losses and Backpropagation</p><p id="text15"><span>Finally, as a technical detail, we found that the losses as defined did not drop quickly. Rather than using the sum of the content losses and the style losses, we used the mean squared error. Our results were extremely similar with both kinds of losses.</span><br> <br> <span>Moreover, we found that images were of significantly higher quality (and converged faster) if performing gradient updates on the style and content losses <em>individually</em>. Rather than maintaining a single gradient graph, we used backward propagation on both individually. Then, we passed the weighted, combined loss to the L-BFGS optimizer, so that we were still running the same optimization problem as the paper.</span></p><h2 id="text07">Our Favorite Results</h2><p id="text29">Mediterranean</p><div class="gallery" id="gallery01"><div class="inner"><ul><li><img src="./final_files/01.jpg" alt="Content - Mediterranean"></li><li><img src="./final_files/02.jpg" alt="Style - Mediterranean Garden"></li></ul></div></div><div class="image" id="image14"><img src="./final_files/image14.jpg" alt=""></div><p id="text30">Starry Night</p><div class="gallery" id="gallery02"><div class="inner"><ul><li><img src="./final_files/01(1).jpg" alt="Content - Starry Night"></li><li><img src="./final_files/02(1).jpg" alt="Style - Starry Night"></li></ul></div></div><div class="image" id="image07"><img src="./final_files/image07.jpg" alt=""></div><p id="text31">Desert</p><div class="gallery" id="gallery03"><div class="inner"><ul><li><img src="./final_files/01(2).jpg" alt="Content - Desert"></li><li><img src="./final_files/02(2).jpg" alt="Style - Desert"></li></ul></div></div><div class="image" id="image08"><img src="./final_files/image08.jpg" alt=""></div><p id="text32">Afremov - Expressionist Flower Market</p><div class="gallery" id="gallery04"><div class="inner"><ul><li><img src="./final_files/01(3).jpg" alt="Untitled"></li><li><img src="./final_files/02(3).jpg" alt="Untitled"></li></ul></div></div><div class="image" id="image09"><img src="./final_files/image09.jpg" alt=""></div><p id="text33">Mountain</p><div class="gallery" id="gallery05"><div class="inner"><ul><li><img src="./final_files/01(4).jpg" alt="Untitled"></li><li><img src="./final_files/02(4).jpg" alt="Untitled"></li></ul></div></div><div class="image" id="image10"><img src="./final_files/image10.jpg" alt=""></div><p id="text34">Cubist Tiger</p><div class="gallery" id="gallery06"><div class="inner"><ul><li><img src="./final_files/01(5).jpg" alt="Untitled"></li><li><img src="./final_files/02(5).jpg" alt="Untitled"></li></ul></div></div><div class="image" id="image11"><img src="./final_files/image11.jpg" alt=""></div><p id="text35">Monet</p><div class="gallery" id="gallery08"><div class="inner"><ul><li><img src="./final_files/01(6).jpg" alt="Untitled"></li><li><img src="./final_files/02(6).jpg" alt="Untitled"></li></ul></div></div><div class="image" id="image13"><img src="./final_files/image13.jpg" alt=""></div><p id="text19">Bonus: Season Transfer</p><div class="gallery" id="gallery07"><div class="inner"><ul><li><img src="./final_files/01(7).jpg" alt="Untitled"></li><li><img src="./final_files/02(7).jpg" alt="Untitled"></li></ul></div></div><div class="image" id="image12"><span class="deferred" style="background-image: none; background-size: 100%; background-position: left top; background-repeat: no-repeat;"><img src="./final_files/image12.jpg" data-src="done" alt="" style="opacity: 1; transition: opacity 0.375s ease-in-out;"></span></div><p id="text20">Bonus: Portraits</p><div class="gallery" id="gallery09"><div class="inner"><ul><li><img src="./final_files/01(8).jpg" alt="Untitled"></li><li><img src="./final_files/02(8).jpg" alt="Untitled"></li><li><img src="./final_files/03.jpg" alt="Untitled"></li></ul></div></div><div class="image" id="image15"><img src="./final_files/image15.jpg" alt=""></div><div class="image" id="image16"><img src="./final_files/image16.jpg" alt=""></div><p id="credits"><a href="https://carrd.co/">( Made with Carrd )</a></p></div></div></div><script>var on = addEventListener,$ = function(q) { return document.querySelector(q) },$$ = function(q) { return document.querySelectorAll(q) },$body = document.body,$inner = $('.inner'),client = (function() {var o = {browser: 'other',browserVersion: 0,os: 'other',osVersion: 0},ua = navigator.userAgent,a, i;a = [['firefox', /Firefox\/([0-9\.]+)/],['edge', /Edge\/([0-9\.]+)/],['safari', /Version\/([0-9\.]+).+Safari/],['chrome', /Chrome\/([0-9\.]+)/],['ie', /Trident\/.+rv:([0-9]+)/]];for (i=0; i < a.length; i++) {if (ua.match(a[i][1])) {o.browser = a[i][0];o.browserVersion = parseFloat(RegExp.$1);break;}}a = [['ios', /([0-9_]+) like Mac OS X/, function(v) { return v.replace('_', '.').replace('_', ''); }],['ios', /CPU like Mac OS X/, function(v) { return 0 }],['android', /Android ([0-9\.]+)/, null],['mac', /Macintosh.+Mac OS X ([0-9_]+)/, function(v) { return v.replace('_', '.').replace('_', ''); }],['windows', /Windows NT ([0-9\.]+)/, null]];for (i=0; i < a.length; i++) {if (ua.match(a[i][1])) {o.os = a[i][0];o.osVersion = parseFloat( a[i][2] ? (a[i][2])(RegExp.$1) : RegExp.$1 );break;}}return o;}()),trigger = function(t) {if (client.browser == 'ie') {var e = document.createEvent('Event');e.initEvent(t, false, true);dispatchEvent(e);} else dispatchEvent(new Event(t));};on('load', function() {setTimeout(function() {$body.className = $body.className.replace(/\bis-loading\b/, 'is-playing');setTimeout(function() {$body.className = $body.className.replace(/\bis-playing\b/, 'is-ready');}, 1000);}, 100);});var style, sheet, rule;style = document.createElement('style');style.appendChild(document.createTextNode(''));document.head.appendChild(style);sheet = style.sheet;if (client.os == 'android') {(function() {sheet.insertRule('body::after { }', 0);rule = sheet.cssRules[0];var f = function() {rule.style.cssText = 'height: ' + (Math.max(screen.width, screen.height)) + 'px';};on('load', f);on('orientationchange', f);on('touchmove', f);})();} else  if (client.os == 'ios') {(function() {sheet.insertRule('body::after { }', 0);rule = sheet.cssRules[0];rule.style.cssText = '-webkit-transform: scale(1.0)';})();(function() {sheet.insertRule('body.ios-focus-fix::before { }', 0);rule = sheet.cssRules[0];rule.style.cssText = 'height: calc(100% + 60px)';on('focus', function(event) {$body.classList.add('ios-focus-fix');}, true);on('blur', function(event) {$body.classList.remove('ios-focus-fix');}, true);})();} else  if (client.browser == 'ie') {(function() {var t, f;f = function() {var mh, h, s, xx, x, i;x = $('#wrapper');x.style.height = 'auto';if (x.scrollHeight <= innerHeight)x.style.height = '100vh';xx = $$('.container.full');for (i=0; i < xx.length; i++) {x = xx[i];s = getComputedStyle(x);x.style.minHeight = '';x.style.height = '';mh = s.minHeight;x.style.minHeight = 0;x.style.height = '';h = s.height;if (mh == 0)continue;x.style.height = (h > mh ? 'auto' : mh);}};(f)();on('resize', function() {clearTimeout(t);t = setTimeout(f, 250);});on('load', f);})();}(function() {var items = $$('.deferred'),f;if (!('forEach' in NodeList.prototype))NodeList.prototype.forEach = Array.prototype.forEach;items.forEach(function(p) {var i = p.firstChild;p.style.backgroundImage = 'url(' + i.src + ')';p.style.backgroundSize = '100% auto';p.style.backgroundPosition = 'top left';p.style.backgroundRepeat = 'no-repeat';i.style.opacity = 0;i.style.transition = 'opacity 0.375s ease-in-out';i.addEventListener('load', function(event) {if (i.dataset.src !== 'done')return;if (Date.now() - i._startLoad < 375) {p.classList.remove('loading');p.style.backgroundImage = 'none';i.style.transition = '';i.style.opacity = 1;} else  {p.classList.remove('loading');i.style.opacity = 1;setTimeout(function() {p.style.backgroundImage = 'none';}, 375);}});});f = function() {var height = document.documentElement.clientHeight,top = (client.os == 'ios' ? document.body.scrollTop : document.documentElement.scrollTop),bottom = top + height;items.forEach(function(p) {var i = p.firstChild;if (i.offsetParent === null)return true;if (i.dataset.src === 'done')return true;var x = i.getBoundingClientRect(),imageTop = top + Math.floor(x.top) - height,imageBottom = top + Math.ceil(x.bottom) + height,src;if (imageTop <= bottom && imageBottom >= top) {src = i.dataset.src;i.dataset.src = 'done';p.classList.add('loading');i._startLoad = Date.now();i.src = src;}});};on('load', f);on('resize', f);on('scroll', f);})();</script></body></html>